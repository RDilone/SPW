<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:components="http://xmlns.jcp.org/jsf/composite/components">


    <style >

        .datepicker {
            width: 100% !important;
            margin-bottom: 15px !important;
        }

        .md4{
            padding-right: 30px;
        }

        .campoTexto {
            width: 100%;
            margin-bottom: 15px !important;
        }


        .etiqueta {
            font-size: 1.1em !important;
        }

        .datoPersona{
            font-weight: normal !important;
        }

        .tituloSeccion {
            font-size: 18px !important; 
            font-weight: normal !important; 
            margin-bottom: 15px !important;
        }

        .box-title {
            font-family: 'Varela Round', sans-serif;
            font-weight: 400;
            font-size: 1.1em;
            margin: 0px;
            margin-top: 5px;
            text-shadow: rgba(255,255,255,255) 0px 2px 4px;
        }

        .newForm {
            font-family: 'Varela Round', sans-serif;
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 20px;
            width: 100%;
            border-radius: 10px;   
            background-color: white;
            box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 1px 0px, 
                        rgba(60, 64, 67, 0.15) 1.5px 1.5px 3px 1px;
        }

        .titulo2 {
            font-family: 'Varela Round', sans-serif;
            font-weight: bold;
            font-size: 1.5em;
            margin: 0px
        }


        .separador {
            display: flex; 
            align-items: center; 
            border: none; 
            border-left: 1px solid hsla(200, 10%, 70%,100); 
            width: 1px; 
            height: 90vh;
            margin-top: -5px;
        }

        @media(max-width: 1200px){
            .movilView {
                display: flex; 
                align-items: center; 
                border: none;
                border-bottom: 1px solid hsla(200, 10%, 70%,100);
                margin-bottom: 20px;
                margin-top: 20px;
                width: 100%;
                height: 12px;
            }


        }

        .padd {
            padding-right: 0px;
        }


        @media(max-width: 991px){

            .padd {
                padding: 0px;
            }

            .campoTexto {
                width: 100%;
            }


            .botonTexto2 {
                float: right;
                width: 15%;
            }

            .menus {
                font-weight: bold !important;
                background: #374850 !important;
            }

        }

    </style>



    <h:form id="formPrestamo" class="form-horizontal">

        <div class="col-xs-12" >
            <div class="row" >
                <div class="newForm" >

                    <div class="col-xs-12 col-sm-6" >                   
                        <p class="titulo2" >
                            <img height="50" 
                                 style="margin-right: 10px; 
                                        margin-bottom: 10px;" 
                                 src="resources/images/statistics.png" /> 
                            Detalles del Préstamo
                        </p>
                    </div>   

                    <div class="col-xs-12 col-sm-6">
                        <div class="row" >
                            <div class="col-xs-12" >
                                <h3 class="box-title" >Cliente: <b>#{detallePrestamoBean.nombre}</b></h3>
                            </div>

                            <div class="col-xs-12" >
                                <h3 class="box-title" >Cel. <b>#{detallePrestamoBean.celular}</b></h3>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="newForm" >

                    <div class="col-xs-12" style="margin-bottom: 10px;" >

                        <div class="row" >

                            <div class="col-lg-12 col-md-12 col-sm-12" style="padding-left: 0px; padding-right: 0px;" >

                                <div class="col-lg-3 md4">
                                    <div class="row">
                                        <p:outputLabel for="mont" value="Capital prestado" class="etiqueta" /><br/>
                                        <p:inputNumber id="mont" 
                                                       inputStyleClass="datepicker"
                                                       readonly="true"
                                                       value="#{detallePrestamoBean.capitalPrestado}" 
                                                       class="campoTexto" />
                                    </div>

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Tasa de interés" class="etiqueta"/><br/>
                                        <p:inputNumber id="tas" 
                                                       readonly="true"
                                                       symbol=" %"
                                                       inputStyleClass="datepicker"
                                                       symbolPosition="s"
                                                       value="#{detallePrestamoBean.tasa}" 
                                                       class="campoTexto"/>
                                    </div>



                                    <div class="row">
                                        <p:outputLabel for="@next" value="Periodo" class="etiqueta"/><br/>
                                        <p:inputText id="per" 
                                                     readonly="true"
                                                     value="#{detallePrestamoBean.periodo.intervalo}" 
                                                     class="campoTexto"/>
                                    </div>

                                </div>


                                <div class="col-lg-3 md4">

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Balance actual" class="etiqueta"/><br/>
                                        <p:inputNumber id="bal"  
                                                       inputStyleClass="datepicker"
                                                       readonly="true"
                                                       value="#{detallePrestamoBean.balance}" 
                                                       class="campoTexto" />


                                    </div>

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Tipo de interés" class="etiqueta"/><br/>
                                        <p:inputText id="tip" 
                                                     readonly="true"
                                                     value="#{detallePrestamoBean.tipoInteres}" 
                                                     class="campoTexto"/>
                                    </div>

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Intervalo de Pago" class="etiqueta"/><br/>
                                        <p:inputText id="int" 
                                                     value="#{detallePrestamoBean.intervaloPago.intervalo}" 
                                                     class="campoTexto"/>
                                    </div>

                                </div>


                                <div class="col-lg-3 md4">

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Ganancias" class="etiqueta"/><br/>
                                        <p:inputNumber id="gan" 
                                                       readonly="true"
                                                       inputStyleClass="datepicker"
                                                       value="#{detallePrestamoBean.ganancias}" 
                                                       class="campoTexto"/>
                                    </div>

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Porcentaje mora" class="etiqueta"/><br/>
                                        <p:inputNumber id="pmo" 
                                                       inputStyleClass="datepicker"
                                                       symbol=" %"
                                                       symbolPosition="s"
                                                       value="#{detallePrestamoBean.porcentajeMora}" 
                                                       class="campoTexto"/>
                                    </div>

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Estado" class="etiqueta"/><br/>
                                        <p:inputText id="est" 
                                                     readonly="true"
                                                     value="#{detallePrestamoBean.estado}" 
                                                     class="campoTexto"/>
                                    </div>


                                </div>

                                <div class="col-lg-3 md4">

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Id Prestamo" class="etiqueta"/><br/>
                                        <p:inputNumber id="idp" 
                                                       readonly="true"
                                                       inputStyleClass="datepicker"
                                                       value="#{detallePrestamoBean.idPrestamo}" 
                                                       class="campoTexto"/>
                                    </div> 

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Cantidad de cuotas" class="etiqueta"/><br/>
                                        <p:inputNumber id="c_cou" 
                                                       readonly="true"
                                                       inputStyleClass="datepicker"
                                                       value="#{detallePrestamoBean.cantCuotas}" 
                                                       class="campoTexto"/>
                                    </div>

                                    <div class="row">
                                        <p:outputLabel for="@next" value="Plazo" class="etiqueta"/><br/>
                                        <p:inputNumber id="pla" 
                                                       readonly="true"
                                                       inputStyleClass="datepicker"
                                                       symbol=" (#{detallePrestamoBean.periodo.plural})"
                                                       symbolPosition="s"
                                                       value="#{detallePrestamoBean.plazo}" 
                                                       class="campoTexto"/>
                                    </div>
                                </div>

                                <div class="col-lg-6 md4">
                                    <div class="row">
                                        <p:outputLabel for="@next" value="Concepto" class="etiqueta"/><br/>
                                        <p:inputText id="con" 
                                                     value="#{detallePrestamoBean.concepto}" 
                                                     class="campoTexto"/>
                                    </div>  
                                </div>


                                <div class="col-lg-6 md4">
                                    <div class="row">
                                        <p:outputLabel for="@next" value="Descripción de Garantía" class="etiqueta"/><br/>
                                        <p:inputText id="d_gar" 
                                                     value="#{detallePrestamoBean.descGarantia}" 
                                                     style="width: 100%; margin-bottom: 15px;"/>
                                    </div>
                                </div>

                                <div class="col-lg-3 md4">
                                    <div class="row">
                                        <p:outputLabel for="@next" value="Fecha inicio" class="etiqueta"/><br/>
                                        <p:inputText id="f_ini" 
                                                     readonly="true"
                                                     value="#{detallePrestamoBean.formatDate(detallePrestamoBean.fechaInicio)}" 
                                                     class="campoTexto"/>
                                    </div>
                                </div>

                                <div class="col-lg-3 md4">
                                    <div class="row">
                                        <p:outputLabel for="@next" value="Fecha final" class="etiqueta"/><br/>
                                        <p:inputText id="f_fin" 
                                                     readonly="true"
                                                     value="#{detallePrestamoBean.formatDate(detallePrestamoBean.fechaFinal)}" 
                                                     class="campoTexto"/>
                                    </div>
                                </div>

                                <div class="col-lg-6 md4" >
                                    <div class="row">
                                        <div class="col-lg-6 col-md-6" style="padding: 0px;" >

                                            <br/>

                                            <p:commandLink id="menu" 
                                                           style="width: 100%; 
                                                           margin-top: 2px; 
                                                           margin-bottom: 15px;"
                                                           class="btn btn-warning pull-right">       
                                                <i class="pi pi-bars" style="margin-right: 5px;" ></i>
                                                <b>Menú de Opciones</b>
                                            </p:commandLink>

                                            <p:menu overlay="true" 
                                                    trigger="menu" 
                                                    my="left top" 
                                                    at="left bottom"
                                                    style="margin-top: 2px; 
                                                    margin-bottom: 15px;" >

                                                <p:menuitem value="Refinanciar" 
                                                            onclick="PF('t_ref').show();" 
                                                            disabled="#{detallePrestamoBean.checkRefinance}"
                                                            icon="pi pi-sync" 
                                                            update="@([id$=formRefinanciar])"/>

                                                <p:menuitem value="Amortización" 
                                                            onclick="PF('t_amo_edit').show();" 
                                                            icon="pi pi-book" 
                                                            update="@([id$=formAmortizacionEdit])"/>

                                                <p:menuitem value="Historial Pago" 
                                                            onclick="PF('t_hist').show();" 
                                                            icon="pi pi-credit-card"
                                                            update="@([id$=formHistorialPago])" />

                                                <p:menuitem value="Información Cliente" 
                                                            onclick="PF('dialogPersona').show();" 
                                                            action="#{detallePrestamoBean.editPersona()}"
                                                            icon="pi pi-user-edit"
                                                            update="@([id$=editPersona])" />

                                                <p:menuitem value="Docs. Adjuntos" 
                                                            onclick="PF('archivo').show();"
                                                            update="@([id$=agregarArchivo])"
                                                            icon="pi pi-file-pdf"/>

                                                <p:menuitem value="Historial Préstamo" 
                                                            actionListener="#{historialPrestamoBean.fillListHistorialPrestamo()}"
                                                            action="#{navigationBean.showHistorialPrestamo()}" 
                                                            update="@([id$=principal])" 
                                                            icon="pi pi-history"/>

                                            </p:menu>

                                        </div>

                                        <div class="col-lg-6 col-md-6 padd">
                                            <br/>
                                            <p:commandLink id="add" 
                                                           style="width: 100%; margin-top: 2px;"
                                                           class="btn btn-primary pull-right" 
                                                           action="#{detallePrestamoBean.savePrestamo()}"
                                                           update="formPrestamo">       
                                                <i class="pi pi-save" style="margin-right: 5px;"></i>
                                                <b>Guardar</b>
                                            </p:commandLink>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>        

                </div>  
                
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12 pull-left" >
                <p:commandLink class="btn btn-danger" 
                               style="width: 100%;" 
                               update="principal"
                               action="#{navigationBean.showPreVentana()}">
                    <i class="pi pi-arrow-circle-left" style="padding-right: 5px;" ></i>
                    <b>Atrás</b>
                </p:commandLink>
            </div>
            </div>
        </div>

    </h:form>



    <components:dialogHistorialPago listHistorialPago="#{detallePrestamoBean.listHistorialPago}"
                                    printHistorialPago="#{detallePrestamoBean.printReportHistorialPago()}"/>

    <components:dialogAmortizacionEdit listAmortizacion="#{detallePrestamoBean.listAmortizacion}"
                                       executeActions="#{detallePrestamoBean.executeActions()}"
                                       enviarCorreo="#{detallePrestamoBean.enviarCorreo}"
                                       imprimirPdf="#{detallePrestamoBean.imprimirPdf}"/>

    <components:dialogRefinanciarPrestamo listAmortizacion="#{detallePrestamoBean.listAmortizacion}"
                                          showNuevoPrestamo="#{navigationBean.showNuevoPrestamo()}"/>

    <components:dialogPersonas nombre="#{detallePrestamoBean.nombre}"
                               cedula="#{detallePrestamoBean.cedula}"
                               direccion="#{detallePrestamoBean.direccion}"
                               celular="#{detallePrestamoBean.celular}"
                               telefono="#{detallePrestamoBean.telefono}"
                               correo="#{detallePrestamoBean.correo}"
                               numTarjeta="#{detallePrestamoBean.numTarjeta}"
                               pinTarjeta="#{detallePrestamoBean.pin}"
                               guardar="#{detallePrestamoBean.updatePersona()}"
                               streamedContent="#{detallePrestamoBean.loadImage}"
                               uploadListener="#{detallePrestamoBean.uploadImage}"
                               elementUpdate="formPrestamo"/>
 
    <components:dialogArchivos listArchivos="#{detallePrestamoBean.listArchivo}"
                               fileSelected="#{detallePrestamoBean.archivoSeleccionado}"
                               uploadListenerFile="#{detallePrestamoBean.uploadFile}"
                               deleteFile="#{detallePrestamoBean.deleteFile()}"
                               uploadedFile="#{detallePrestamoBean.uploadedFile}"
                               downloadFile="#{detallePrestamoBean.downloadSelectedFile()}"/>
    
    

</ui:composition>


