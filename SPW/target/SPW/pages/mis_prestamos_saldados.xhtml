<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:composite="http://java.sun.com/jsf/composite">


    <style >
        .tarjeta {
            font-family: 'Varela Round', sans-serif;
            display: flex;
            flex-wrap: wrap;
            width: 100%;
            height: auto;
            padding: 7px;
            border-radius: 10px;   
            background-color: white;
            box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px, rgba(60, 64, 67, 0.15) 0px 2px 6px 2px;
        }

        .image {
            width: 100%;
            height: 100%;
        }

        .detalle {           
            display: flex;
            flex-wrap: wrap;
            overflow: hidden;
            border-radius: 10px;
            width: 100%;
            height: 170px;
        }

        .padless {
            padding: 0px;
        }

        .padSet {
            display: flex;
            align-items: center;
            padding-bottom: 20px;
        }

        .head {
            padding: 0px;
        }

        .titulo {
            font-family: 'Varela Round', sans-serif;
            font-weight: bold;
            height: 35px;
            margin-top: 15px;
            margin-bottom: 0px;
            font-size: 1.3em;
        }

        .newForm {
            font-family: 'Varela Round', sans-serif;
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 20px;
            width: 100%;
            border-radius: 10px;   
            background-color: white;
            box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 1px 0px, 
                rgba(60, 64, 67, 0.15) 1.5px 1.5px 3px 1px;
        }

        .titulo2 {
            font-family: 'Varela Round', sans-serif;
            font-weight: bold;
            font-size: 1.5em;
            margin: 0px
        }


        .search {
            width: 100%; 
            display: flex; 
            float: right;
            margin-top: 7px;
            border-radius: 10px;
            box-shadow: rgba(0, 0, 0, 0.1) 0px 5px 5px -5px, rgba(0, 0, 0, 0.04) 8px 5px 5px -5px;
        }

        .info {         
            font-size: 1.1em;
            color: #778da9;
        }

        .fechaP {
            color: #ffbe0b;
        }

        .cel {
            color: #3a86ff;
        }

        .boton {
            font-family: 'Varela Round', sans-serif;
            text-align: center;
            width: 80px;
            height: 80px;
            border-radius: 100%;
            padding: 0px;
            margin: 0px;
            margin-top: 10px;
            background-color: #0077b6;
            text-decoration: none;
            color: white;
            box-shadow: rgba(0, 0, 0, 0.30) 0px 5px 8px;
        }

        .abrirTexto {
            visibility: hidden;
        }

        .icon {
            font-size: 2em; 
            margin-top: 23px;     
        }

        .peso {
            display: block;
        }

        .contBoton {
            padding: 3% 3%;
        }

        .boton:hover{
            color: white;
        }

        .flexDisplay {
            display: flex;
            flex-wrap: wrap;
        }
        

        @media(max-width: 767px) {
            

            
            .search {
                margin-top: 15px;
            }
            
            .titulo {
                margin-bottom: 15px;
            }
            
            .detalle {
                height: 250px;
            }

            .boton {
                font-family: 'Varela Round', sans-serif;
                text-align: center;
                width: 100%;
                height: 60px;
                margin-bottom: 15px;
                padding: 1em 1.5em;
                background-color: #0077b6;
                text-decoration: none;
                color: white;
                border-radius: 10px;
                box-shadow: rgba(0, 0, 0, 0.30) 0px 5px 8px;
            }

            .icon {
                font-size: 1.4em; 
                margin: 0px;
            }

            .abrirTexto {
                visibility: visible;
            }
        }


    </style>





    <h:form id="formPrestamosSaldados" >
        <p:focus for="buscar" context="formPrestamosSaldados"/>
        <div class="col-xs-12" >
            <div class="row" >
                <div class="newForm" >
                    <div class="col-xs-12 col-md-7" >
                        <p class="titulo2" >
                            <img height="50" style="margin-right: 10px;" src="resources/images/time-money.png" /> 
                            Mis Préstamos Saldados
                        </p>                                                
                    </div>


                    <div class="col-xs-12 col-md-5" >
                        

                        <p:remoteCommand name="test" 
                                         action="#{misPrestamosSaldados.updateListAmortizacion()}" 
                                         update="@([id$=formPrestamosSaldados])"/>
                        <p:inputText id="buscar" 
                                     onfocus="this.setSelectionRange(0, this.value.length)"
                                     value="#{misPrestamosSaldados.buscarPrestamo}"
                                     onkeypress="if (event.keyCode == 13) {
                                                 test();
                                                 return false;
                                             }"
                                     class="search"
                                     placeholder="Buscar por Nombre... Enter"/>
                    </div>
                </div>   
            </div>
        </div>


        <p:repeat id="listPrest" 
                  value="#{misPrestamosSaldados.listPrestamos}" 
                  var="prest">



            <div class="col-xs-12 padless" style="margin-bottom: 20px;" >
                <div class="tarjeta" >
                    <div class="col-xs-12 col-sm-4 col-md-3 padless flexDisplay" >
                        <div class="detalle" >
                            
                            <p:graphicImage value="#{misPrestamosSaldados.downloadFile(prest.idPersona.fotoCedula)}" 
                                            stream="false"
                                            class="image" />
                        </div>
                    </div>


                    <div class="col-xs-12 col-sm-6 col-md-7" style="padding-left: 25px; padding-top: 5px;">
                        <div class="row" >
                            <div class="col-sm-12" >
                                <h4 class="titulo">#{prest.idPersona.nombre}</h4>
                            </div>
                        </div>
                                        
                        
                        <div class="col-xs-6 col-sm-12 padless" >
                            <div class="row" >
                                <div class="col-xs-12 col-sm-4" >
                                    <p:outputLabel value="Capital Prestado"/><br/>
                                    <p class="info" >#{misPrestamosSaldados.formatMoney(prest.capitalPrestado)}</p>
                                </div>

                                <div class="col-xs-12 col-sm-4" >
                                    <p:outputLabel value="Ganancias"/><br/>
                                    <p class="info" >#{misPrestamosSaldados.formatMoney(prest.ganancia)}</p>
                                </div>

                                <div class="col-xs-12 col-sm-4" >
                                    <p:outputLabel value="Plazo"/><br/>
                                    <p class="info" >#{prest.plazo} #{prest.idIntervaloInteres.plural}</p>
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-6 col-sm-12 padless" >
                            <div class="row" >

                                <div class="col-xs-12 col-sm-4" >
                                    <p:outputLabel value="Duración"/><br/>
                                    <p class="info" >#{misPrestamosSaldados.getDurationLoan(prest.fechaInicio, prest.fechaFinal)}</p>
                                </div>

                                <div class="col-xs-12 col-sm-4" >
                                    <p:outputLabel value="Fecha Inicio"/><br/>
                                    <p class="info" >#{misPrestamosSaldados.formatDate(prest.fechaInicio)}</p>
                                </div>

                                <div class="col-xs-12 col-sm-4" >
                                    <p:outputLabel value="Fecha Final"/><br/>
                                    <p class="info" >#{misPrestamosSaldados.formatDate(prest.fechaFinal)}</p>
                                </div>
                            </div> 
                        </div>

                    </div>

                    <div class="col-xs-12 col-sm-2 padless contBoton flexDisplay" >
                        <p:commandLink class="boton"
                                       update="formPrestamosSaldados principal"
                                       title="Detalles"
                                       action="#{misPrestamosSaldados.showDetailsPrestamoSaldado()}"
                                       actionListener="#{misPrestamosSaldados.setPrestamoSeleccionado(prest)}"
                                       style="background-color: #0096c7">             
                            <i class="pi pi-folder-open icon" ></i>
                            <b class="abrirTexto" style="font-size: 1.4em;">Detalles</b>
                        </p:commandLink>
                    </div>
                </div>
            </div>

        </p:repeat>

    </h:form>


</ui:composition>



